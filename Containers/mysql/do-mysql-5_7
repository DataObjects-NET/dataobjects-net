FROM mysql:5.7.44

RUN echo "[mysqld]" >> /etc/mysql/conf.d/mysqld-options.cnf
RUN echo "collation-server = utf8_general_ci" >> /etc/mysql/conf.d/mysqld-options.cnf
RUN echo "character-set-server = utf8" >> /etc/mysql/conf.d/mysqld-options.cnf
RUN echo "sql-mode = 'STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'" >> /etc/mysql/conf.d/mysqld-options.cnf
RUN echo "lower_case_table_names = 1" >> /etc/mysql/conf.d/mysqld-options.cnf
RUN echo "ssl_cipher = 'DHE-RSA-AES128-GCM-SHA256:AES128-SHA:@SECLEVEL=1'" >> /etc/mysql/conf.d/mysqld-options.cnf

COPY init-mysql-instance.sh /docker-entrypoint-initdb.d/

RUN chmod +x /docker-entrypoint-initdb.d/init-mysql-instance.sh
